# product\_lines

## Назначение

Микросервис предназначен для классификации товаров по линейкам на основе наименования. В частности, выделяются детские товары (Baby) и зубные пасты с помпой (Pump). Сервис загружает Excel-файл справочника, проверяет наличие ключевых слов и присваивает линейку соответствующим строкам.

## Установка и запуск

```bash
pip install -r requirements.txt
uvicorn product_lines:app --host 0.0.0.0 --port 8081
```

## API

### GET /lines

Параметры запроса:

* `file_path` (str): путь к Excel-файлу (в URL-кодировке)

#### Описание работы:

1. Сервис открывает Excel-файл по переданному пути и читает лист `SPR_DWH_SKU`.
2. Исключаются строки с группой "Прочее", с пустыми значениями в `Линейка уровень 2`, и с `Код SKU`, равным "Общий итог".
3. Проверка выполняется по наименованию товара:

   * Если содержит ключевые слова из списка `baby_str`, то проставляется линейка `Baby`
   * Если содержит ключевые слова из списка `pump_line`, то проставляется линейка `Pump`
4. Возвращается Excel-файл с колонками: `Артикул`, `Наименование`, `Линейка`

#### Пример запроса:

```http
GET /lines?file_path=%5C%5C10.5.0.20%5C%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B8%5CPBI%5C%D0%9F%D0%A0%D0%9E%D0%94%D0%90%D0%96%D0%98%5C%D0%A1%D0%9F%D0%A0%D0%90%D0%92%D0%9E%D0%A7%D0%9D%D0%98%D0%9A.xlsx
```

#### Пример ответа:

Ответ — это Excel-файл (`Content-Disposition: attachment`) с результатами классификации.

## Примечания

* Обрабатываемый файл должен содержать лист `SPR_DWH_SKU` и колонки: `Код SKU`, `Уник. названия групп`, `Линейка уровень 2`, наименование товара во второй колонке.
* Ключевые слова для линейки `Baby` и `Pump` задаются вручную и могут быть расширены при необходимости.
* Пути к файлам необходимо передавать в URL-кодировке (например, с помощью `urllib.parse.quote`).

## Зависимости

Основные используемые библиотеки:

* fastapi
* uvicorn
* pandas
* openpyxl

Полный список см. в `requirements.txt`.
